!function(e,t){for(var o in t)e[o]=t[o]}(exports,function(e){var t={};function o(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,o),s.l=!0,s.exports}return o.m=e,o.c=t,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(r,s,function(t){return e[t]}.bind(null,s));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=5)}([function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("os")},function(e,t){e.exports=require("child_process")},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=o(1),s=o(2),n=o(0);let a;t.getWSLExecutablePath=function(){let e=function(){const e=/(\d+)\.(\d+)\.(\d+)/g.exec(s.release());let t=0;return e&&4===e.length&&(t=parseInt(e[3])),t}()>=16299;const t=process.env.hasOwnProperty("PROCESSOR_ARCHITEW6432"),o=process.env.SystemRoot;if(o)return r.join(o,t?"Sysnative":"System32",e?"wsl.exe":"bash.exe")},t.getProductConfiguration=function(e){if(!a){const t=n.readFileSync(r.join(e,"product.json")).toString();a=JSON.parse(t)}return a}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=o(6),s=o(3),n=o(1),a=o(7),i=o(2),c=o(0),l=o(4);let d=void 0;const u=!!process.env.VSCODE_DEV,m=process.env.VSCODE_WSL_AGENT_DEBUG_PORT||(u?"15870":""),p=n.join(__dirname,"wslDaemon.js");let f=void 0,w=[],h=!1;function g(){if(f)f.terminal.show();else{(f=r.window.createTerminalRenderer("WSL")).terminal.show();const e=e=>f.write(e);w.forEach(e),w.length=0}}function S(e,t=!1){const o=e.split(/\r?\n/);for(let e=0;e<o.length;e++){const r=o[e];(r.length||e<o.length-1)&&v(r,t)}}function v(e,t=!1){const o=`[[32m${(new Date).toISOString().replace(/[TZ]/g," ").trim()}[0m] ${t?"[31m":""}${e}\r\n`;f?f.write(o):w.push(o)}t.activate=function(e){const t=e.subscriptions,o=n.dirname(n.dirname(n.dirname(e.logPath)));t.push(r.workspace.registerRemoteAuthorityResolver("wsl",new _(o,e.extensionPath))),t.push(r.commands.registerCommand("remote-wsl.newWindow",async()=>{if(!h){const e=l.getWSLExecutablePath();!(h=!!e&&c.existsSync(e))&&e&&v(`WSL executable not found at ${e}`)}if(h)r.commands.executeCommand("vscode.newWindow",{remoteAuthority:"wsl+default"});else{const e="Documentation";await r.window.showErrorMessage("WSL executable not found. Please make sure that WSL is installed.",e)===e&&r.env.openExternal(r.Uri.parse("https://aka.ms/vscode-remote/wsl/install-wsl"))}})),t.push(r.commands.registerCommand("remote-wsl.showLog",()=>{g()})),t.push(r.commands.registerCommand("remote-wsl.getHelp",async()=>r.env.openExternal(r.Uri.parse("https://aka.ms/vscode-remote/wsl")))),t.push(r.commands.registerCommand("remote-wsl.getStarted",async()=>r.env.openExternal(r.Uri.parse("https://aka.ms/vscode-remote/wsl/getting-started")))),t.push(r.commands.registerCommand("remote-wsl.provideFeedback",async()=>r.env.openExternal(r.Uri.parse("https://aka.ms/vscode-remote/wsl/provide-feedback")))),t.push(r.commands.registerCommand("remote-wsl.reportIssue",async()=>r.commands.executeCommand("vscode.openIssueReporter","ms-vscode-remote.remote-wsl")))};class _{constructor(e,t){let o=a.createHash("sha1").update(e).digest("hex");this._pipeName=`\\\\.\\pipe\\vscode-wsl-${o}-${r.version}-sock`,this._extensionLocation=t}resolve(e){return r.window.withProgress({location:r.ProgressLocation.Notification,title:"Installing VS Code Server in WSL ([details](command:remote-wsl.showLog))",cancellable:!1},t=>this._resolve(e,t))}_resolve(e,t){if("win32"!==process.platform)return Promise.reject(r.RemoteAuthorityResolverError.NotAvailable("WSL is only supported on Windows"));if(d)return d;v("Starting VS Code Server inside WSL."),t.report({message:"Starting Linux Subsystem"});let o=!1;return d=new Promise((e,n)=>{let a=async e=>{if(v(e,!0),!o){o=!0,g(),e+="\r\nCheck WSL terminal for more details.";const t=await r.window.showErrorMessage(e,{modal:!0},...function(){const e=[],t=r.workspace.textDocuments.some(e=>e.isDirty)||r.workspace.workspaceFile&&"untitled"===r.workspace.workspaceFile.scheme;e.push({title:"Retry",execute:async()=>{await r.commands.executeCommand("workbench.action.reloadWindow")}}),t||e.push({title:"Close Remote",execute:async()=>{await r.commands.executeCommand("vscode.newWindow",{reuseWindow:!0})}});return e.push({title:"Ignore",isCloseAffordance:!0,execute:async()=>{r.commands.executeCommand("remote-wsl.showLog")}}),e}());t&&await t.execute(),n(r.RemoteAuthorityResolverError.NotAvailable(e,!0))}},c=s=>{switch(s.type){case"progressMessage":t.report({increment:s.increment,message:s.message});break;case"stdoutMessage":S(s.data);break;case"stderrMessage":S(s.data,!0);break;case"portResolved":o||(o=!0,e(function(e){const t=i.networkInterfaces(),o={};for(let e in t)for(let r of t[e])o[r.address]=!0;let s="localhost";return e.ipAddresses.length&&!e.ipAddresses.some(e=>o[e])&&(s=e.ipAddresses[0]),v(`WSL resolver response: ${s}:${e.port}`),new r.ResolvedAuthority(s,e.port)}(s)));break;case"fatalErrorOccured":a(s.message);break;default:throw new Error("Received unexpected message!")}},l="";try{const e={};Object.keys(process.env).forEach(t=>{e[t]=process.env[t]}),e.VSCODE_WSL_AGENT_DEBUG_PORT=m,e.VSCODE_WSL_PIPE_NAME=this._pipeName,e.VSCODE_WSL_EXT_HOST_PID=process.pid,e.VSCODE_WSL_EXT_LOCATION=this._extensionLocation,e.VSCODE_WSL_APP_ROOT=r.env.appRoot,r.workspace.getConfiguration().get("telemetry.enableTelemetry")&&(e.VSCODE_WSL_ENABLE_TELEMETRY=!0);const t={stdio:["pipe","pipe","pipe","ipc"],detached:!0,env:e,execArgv:[],cwd:process.cwd()},o=s.fork(p,[],t);o.stdout.on("data",e=>{l+=e.toString(),(()=>{let e;for(;(e=l.indexOf("\n"))>0;){let t=JSON.parse(l.substr(0,e));l=l.substr(e+1),c(t)}})()}),o.stderr.on("data",e=>{S(e.toString())}),o.on("error",e=>{a(String(e))}),o.on("close",e=>{a(`WSL Daemon exited with code ${e}`)})}catch(e){a("Problems starting WSL Daemon: "+(e&&e.message||""))}})}}},function(e,t){e.exports=require("vscode")},function(e,t){e.exports=require("crypto")}]));
//# sourceMappingURL=extension.js.map